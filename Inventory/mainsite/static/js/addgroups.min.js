$(document).ready(function(){
    const form = document.getElementById('addGrpFrm');
    form.addEventListener('submit', function(e){
        e.preventDefault();
        const grpName = document.getElementById('group_name').value.trim();
        var allSelPerm = []
        $("input[name='permission[]']:checked").each(function(){
            allSelPerm.push($(this).val());
        });
        createGroup(grpName, allSelPerm)
    })
})

function createGroup(groupname, allSelPerm){
    $.ajax({
        url: "",
        type: "POST",
         headers: {
            "X-CSRFToken" : $("input[name=csrfmiddlewaretoken]").val()
        },
        data: {
            'groupname': groupname,
            'selectedPerm': allSelPerm.toString(),
        },
        success:function(result){
            response = JSON.parse(result);
            if(response.value){
                if(response.value == true){
                    window.location.replace('/managegroups')
                }
            }
            else{
                console.log('Server error');
            }
        },
        errorL: function(result){
            console.log(result);
        }
    })
}